<?php

//require_once 'PAF/Buffer/Interface.php';
//require_once 'PAF/Buffer/AbleInterface.php';
//require_once 'PAF/Buffer/MemorySimple.php';
//require_once 'PAF/Buffer/Memory.php';

/**
 * Test class for PAF_Buffer_Memory.
 * Generated by PHPUnit on 2012-12-02 at 20:51:43.
 */
class PAF_Buffer_MemoryTest extends PHPUnit_Framework_TestCase
{

    /**
     * @var PAF_Buffer_Memory
     */
    protected $object;

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    protected function setUp()
    {
        $this->object = new PAF_Buffer_Memory;
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown()
    {
        
    }

    /**
     * @covers PAF_Buffer_Memory::push
     * @dataProvider pushProvider
     */
    public function testPush($first, $second, $all)
    {
        $this->object->push($first);
        $this->assertEquals($first, $this->object->get());
        $this->object->push($second);
        $this->assertEquals($all, $this->object->get());
    }

    public function pushProvider()
    {
        $data = array();

        $data[] = array('a', 'b', 'ab');
        $data[] = array('a ', 'b ', 'a b ');
        $data[] = array(' a', ' b', ' a b');
        $data[] = array('a' . PHP_EOL, 'b' . PHP_EOL, 'a' . PHP_EOL . 'b' . PHP_EOL);
        $data[] = array(0, 1, '01');
        $data[] = array(NULL, 'a', 'a');
        $data[] = array('', 'a', 'a');
        $data[] = array('a', NULL, 'a');
        $data[] = array(NULL, NULL, '');
        $data[] = array('', '', '');

        return $data;
    }

    /**
     * @covers PAF_Buffer_Memory::startBuffer
     * @todo Implement testStartBuffer().
     */
    public function testStartBuffer()
    {
        $object = new PAF_Buffer_Memory();
        $this->assertNull($object->getBuffer());
        
        $idOne = $object->startBuffer();
        $this->assertEquals('', $object->getBuffer());
        $this->assertEquals('', $object->getBuffer($idOne));
        
        $object->push('PUSHONE;');
        $this->assertEquals('PUSHONE;', $object->getBuffer());
        $this->assertEquals('PUSHONE;', $object->getBuffer($idOne));
        
        $idTwo = $object->startBuffer();
        $this->assertEquals('', $object->getBuffer());
        $this->assertEquals('', $object->getBuffer($idTwo));
        
        $object->push('PUSHTWO;');
        $this->assertEquals('PUSHTWO;', $object->getBuffer());
        $this->assertEquals('PUSHTWO;', $object->getBuffer($idTwo));
        $this->assertEquals('PUSHONE;', $object->getBuffer($idOne));
        
        
    }

    /**
     * @covers PAF_Buffer_Memory::dropBuffer
     * @todo Implement testDropBuffer().
     */
    public function testDropBuffer()
    {
        // Remove the following lines when you implement this test.
        $this->markTestIncomplete(
                'This test has not been implemented yet.'
        );
    }

    /**
     * @covers PAF_Buffer_Memory::flushBuffer
     * @todo Implement testFlushBuffer().
     */
    public function testFlushBuffer()
    {
        // Remove the following lines when you implement this test.
        $this->markTestIncomplete(
                'This test has not been implemented yet.'
        );
    }

    /**
     * @covers PAF_Buffer_Memory::getBuffer
     * @todo Implement testGetBuffer().
     */
    public function testGetBuffer()
    {
        // Remove the following lines when you implement this test.
        $this->markTestIncomplete(
                'This test has not been implemented yet.'
        );
    }

    /**
     * @covers PAF_Buffer_Memory::pull
     * @dataProvider pullProvider
     */
    public function testPull($content)
    {
        $this->object->push($content);
        $this->assertEquals($content, $this->object->get());
        $this->assertEquals($content, $this->object->pull());
        $this->assertEquals('', $this->object->get());
    }

    public function pullProvider()
    {
        $data = array();

        $data[] = array('a');
        $data[] = array('a ');
        $data[] = array(' a');
        $data[] = array('a' . PHP_EOL);
        $data[] = array(PHP_EOL . 'a');
        $data[] = array('a' . PHP_EOL . 'b');

        return $data;
    }

    /**
     * @covers PAF_Buffer_Memory::get
     * @dataProvider getProvider
     */
    public function testGet($content)
    {
        $this->assertEquals('', $this->object->get());
        $this->object->push($content);
        $this->assertEquals($content, $this->object->get());
    }

    public function getProvider()
    {
        return $this->pullProvider();
    }

    /**
     * @covers PAF_Buffer_Memory::stopBuffer
     * @todo Implement testStopBuffer().
     */
    public function testStopBuffer()
    {
        // Remove the following lines when you implement this test.
        $this->markTestIncomplete(
                'This test has not been implemented yet.'
        );
    }

    /**
     * @covers PAF_Buffer_Memory::__get
     */
    public function test__get()
    {
        $this->setExpectedException('PAF_Exception_NoSuchProperty');
        $this->object->unexistingProperty;
    }

    /**
     * @covers PAF_Buffer_Memory::flush
     * @dataProvider flushProvider
     */
    public function testFlush($content)
    {
        $this->object->push($content);
        $this->assertEquals($content, $this->object->get());
        $this->assertEquals($content, $this->object->flush());
        $this->assertEquals('', $this->object->get());
    }

    public function flushProvider()
    {
        return $this->pullProvider();
    }

    /**
     * @covers PAF_Buffer_Memory::__get
     */
    public function testId()
    {
        $ids = array();

        for ($i = 0; $i < 10; $i++)
        {
            $object = new PAF_Buffer_Memory();
            $id = $object->id;
            $this->assertNotContains($id, $ids);
            $ids[] = $id;
        }
    }

}
